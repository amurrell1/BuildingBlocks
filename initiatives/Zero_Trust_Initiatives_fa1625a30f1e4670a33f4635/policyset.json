{
 "properties": {
  "displayName": "Zero_Trust_Initiatives",
  "policyType": "Custom",
  "metadata": {
   "category": "Governance",
   "version": "1.0",
   "parameterScopes": {
    "logAnalytics": "/subscriptions/[subscrtiptionid]/resourcegroups/[resourcegroup]",
    "privateEndpointSubnetId": "/subscriptions/[subscrtiptionid]/resourcegroups/[resourcegroup]/providers/microsoft.network/virtualnetworks/[vnetname]",
    "nsgRegion": "/providers/Microsoft.Management/managementGroups/Production",
    "networkWatcherRG": "/subscriptions/[subscrtiptionid]",
    "workspaceRegion": "/providers/Microsoft.Management/managementGroups/Production"
   },
   "createdBy": "[]",
   "createdOn": "2022-06-17T17:53:46.2424943Z",
   "updatedBy": null,
   "updatedOn": null
  },
  "parameters": {},
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should restrict network access using virtual network rules_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Defender for Storage should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should restrict network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Deploy Advanced Threat Protection on storage accounts_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should have infrastructure encryption_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage Accounts should use a virtual network service endpoint_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/60d21c4f-21a3-4d94-85f4-b924e6aeeda4",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should use private link_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Configure diagnostic settings for storage accounts to Log Analytics workspace_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
    "parameters": {
     "logAnalytics": {
      "value": "/subscriptions/[subscriptionid]/resourcegroups/[rgname]/providers/microsoft.operationalinsights/workspaces/[lawname]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should prevent shared key access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Configure Storage account to use a private link connection_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f766f00-8d11-464e-80e1-4091d7874074",
    "parameters": {
     "privateEndpointSubnetId": {
      "value": "/subscriptions/[subscriptionid]/resourcegroups/[resourcegroup]/providers/microsoft.network/virtualnetworks/[vnetname]/subnets/default"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Configure storage accounts to disable public network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a06d0189-92e8-4dba-b0c4-08d7669fce7d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should disable public network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b2982f36-99f2-4db5-8eff-283140c09693",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Storage accounts should have the specified minimum TLS version_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fe83a0eb-a853-422d-aac2-1bffd182c5d0",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
    "parameters": {
     "logAnalytics": {
      "value": "/subscriptions/[subscriptionid]/resourcegroups/[resourcegroup]/providers/microsoft.operationalinsights/workspaces/[lawname]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resou_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "The Log Analytics extension should be installed on Virtual Machine Scale Sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/efbde977-ba53-4479-b8e9-10b957924fbf",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: vTPM should be enabled on supported virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Network traffic data collection agent should be installed on Linux virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Guest Attestation extension should be installed on supported Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: ChangeTracking extension should be installed on your Windows virtual machine_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/221aac80-54d8-484b-83d7-24f4feac2ce0",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Endpoint protection solution should be installed on virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Network traffic data collection agent should be installed on Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Log Analytics Extension should be enabled for listed virtual machine images_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
    "parameters": {
     "logAnalytics": {
      "value": "/subscriptions/[subscriptionid]/resourcegroups/[resourcegroup]/providers/microsoft.operationalinsights/workspaces/[lawname]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Vulnerabilities in security configuration on your virtual machine scale sets should be remediated_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: ChangeTracking extension should be installed on your Windows virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4bb303db-d051-4099-95d2-e3e1428a4d00",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure ChangeTracking Extension for Windows virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4bb303db-d051-4099-95d2-e3e1428a4d2c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "A vulnerability assessment solution should be enabled on your virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure periodic checking for missing system updates on azure virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/59efceea-0c96-497e-a4a1-4eb2290dac15",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Log Analytics extension should be enabled in virtual machine scale sets for listed virtual machine i_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Deploy Log Analytics extension for Linux virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
    "parameters": {
     "logAnalytics": {
      "value": "/subscriptions/[subscriptionid]/resourcegroups/[resourcegroup]/providers/microsoft.operationalinsights/workspaces/[lawname]"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Guest Attestation extension should be installed on supported Linux virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure supported Windows virtual machines to automatically enable Secure Boot_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7cb1b219-61c6-47e0-b80c-4472cadeeb5f",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure supported Linux virtual machines to automatically install the Guest Attestation_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6074e9a3-c711-4856-976d-24d51f9e065b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Secure Boot should be enabled on supported Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "All network ports should be restricted on network security groups associated to your virtual machine_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Guest Attestation extension should be installed on supported Linux virtual machines scale_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Log Analytics agent should be installed on your virtual machine scale sets for Azure Security Center_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a3a6ea0c-e018-4933-9ef0-5aaa1501449b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Virtual machines should have the Log Analytics extension installed_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a70ca396-0a34-413a-88e1-b956c1e683be",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports of virtual machines should be protected with just-in-time network access control_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Linux virtual machines should use Secure Boot_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b1bb3592-47b8-4150-8db0-bfdcc2c8965b",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Non-internet-facing virtual machines should be protected with network security groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure supported Windows virtual machine scale sets to automatically install the Guest_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9b2ae08-09e2-4f0e-bb43-b60bf0135bdf",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Deploy Microsoft Defender for Endpoint agent on Linux virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d30025d0-6d64-656d-6465-67688881b632",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Configure supported virtual machines to automatically enable vTPM_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e494853f-93c3-4e44-9210-d12f61a64b34",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: ChangeTracking extension should be installed on your Linux virtual machine scale sets_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71c1e29-9c76-4532-8c4b-cb0573b0014c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Virtual machines guest attestation status should be healthy_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f6358610-e532-4236-b178-4c65865eb262",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Guest Attestation extension should be installed on supported Windows virtual machines sca_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Internet-facing virtual machines should be protected with network security groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Virtual machines and virtual machine scale sets should have encryption at host enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Key Vault should use a virtual network service endpoint_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ea4d6841-2173-4317-9747-ff522a45120f",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Virtual machines should be connected to an approved virtual network_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d416745a-506c-48b6-8ab1-83cb814bcaa3",
    "parameters": {
     "virtualNetworkId": {
      "value": "/"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "A custom IPsec/IKE policy must be applied to all Azure virtual network gateway connections_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/50b83b09-03da-41c1-b656-c293c914862b",
    "parameters": {
     "IPsecEncryption": {
      "value": [
       "item1",
       "item2"
      ]
     },
     "IPsecIntegrity": {
      "value": [
       "item1",
       "item2"
      ]
     },
     "IKEEncryption": {
      "value": [
       "item1",
       "item2"
      ]
     },
     "IKEIntegrity": {
      "value": [
       "item1",
       "item2"
      ]
     },
     "DHGroup": {
      "value": [
       "item1",
       "item2"
      ]
     },
     "PFSGroup": {
      "value": [
       "item1",
       "item2"
      ]
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Virtual networks should use specified virtual network gateway_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f1776c76-f58c-4245-a8d0-2b207198dc8b",
    "parameters": {
     "virtualNetworkGatewayId": {
      "value": "/"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: All Internet traffic should be routed via your deployed Azure Firewall_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Deploy a flow log resource with target network security group_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0db34a60-64f4-4bf6-bd44-f95c16cf34b9",
    "parameters": {
     "nsgRegion": {
      "value": "eastus"
     },
     "storageId": {
      "value": "/"
     },
     "networkWatcherRG": {
      "value": "[rgname]"
     },
     "networkWatcherName": {
      "value": "/"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Flow logs should be enabled for every network security group_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/27960feb-a23c-4577-8d36-ef8b5f35e0be",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Network Watcher flow logs should have traffic analytics enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f080164-9f4d-497e-9db6-416dc9f7b48a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Flow logs should be configured for every network security group_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c251913d-7d24-4958-af87-478ed3b9ba41",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Network Watcher flow logs should have traffic analytics enabled_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f080164-9f4d-497e-9db6-416dc9f7b48a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Configure network security groups to enable traffic analytics_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e920df7f-9a64-4066-9b58-52684c02a091",
    "parameters": {
     "nsgRegion": {
      "value": "eastus"
     },
     "storageId": {
      "value": "/"
     },
     "workspaceResourceId": {
      "value": "/"
     },
     "workspaceRegion": {
      "value": "eastus"
     },
     "workspaceId": {
      "value": "/"
     },
     "networkWatcherRG": {
      "value": "[rgname]"
     },
     "networkWatcherName": {
      "value": "/"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled accounts with write permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with owner permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "MFA should be enabled on accounts with read permissions on your subscription_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
    "parameters": {},
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/providers/Microsoft.Management/managementGroups/Production/providers/Microsoft.Authorization/policySetDefinitions/fa1625a30f1e4670a33f4635",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "fa1625a30f1e4670a33f4635"
}
